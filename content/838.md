Title: Symfony2: Doctrine Fixtures + Faker
Date: 2014-01-11 06:22
Author: filipgorczynski
Category: Bazy danych, Programowanie, Rozwiązania
Tags: Doctrine, Doctrine Fixtures, Faker, Lorem ipsum, Symfony2
Slug: 838
Status: draft

[![symfony-logo-250](http://filipgorczynski.files.wordpress.com/2014/01/symfony-logo-250.png?w=150){.alignleft .wp-image-850 width="90" height="90"}](http://filipgorczynski.files.wordpress.com/2014/01/symfony-logo-250.png)Fixtures (czy jest jakiś polski odpowiednik tego słowa?) to dane startowe do projektów. Posiadamy kilka rodzajów

The fixtures is a data configuration for our Symfony 2 project, is a simple but a powerful way to load into the database default or required information for the correct execution of the application. Often, in the development phase, the model changes or even dropped, as the recovery comes tedious the fixtures can save us hours of manual SQL insertions.

To install a Doctrine 2 fixtures system in our Symfony 2 app, we have to add the next lines to the "deps" file.

Faker + Load

\> composer require doctrine/doctrine-fixtures-bundle

---\> doctrine/data-fixtures

\> composer require fzaninotto/faker

\[code language="php"\]  
\<?php  
namespace Fkg\\DemoBundle\\DataFixtures\\ORM;

use Doctrine\\Common\\DataFixtures\\AbstractFixture;  
use Doctrine\\Common\\DataFixtures\\OrderedFixtureInterface;  
use Doctrine\\Common\\Persistence\\ObjectManager;  
use Doctrine\\Common\\DataFixtures\\ReferenceRepository;  
use Fkg\\DemoBundle\\Entity\\Category;

class CategoryFixtures extends AbstractFixture implements OrderedFixtureInterface  
{  
public function load(ObjectManager \$manager)  
{  
\$referenceRepository = new ReferenceRepository(\$manager);

\$categories = array(  
'Category 1',  
'Category 2',  
'Category 3',  
);

foreach (\$categories as \$key =\> \$value) {  
\$category = new Category();  
\$category-\>setName(\$value);  
\$category-\>setIsActive(true);  
\$manager-\>persist(\$category);  
\$this-\>addReference("category-{\$key}", \$category);  
}

\$manager-\>flush();  
}

public function getOrder()  
{  
return 1;  
}  
}  
\[/code\]

 

\[code language="php"\]

\<?php  
namespace Fkg\\DemoBundle\\DataFixtures\\ORM;

use Doctrine\\Common\\DataFixtures\\AbstractFixture;  
use Doctrine\\Common\\DataFixtures\\OrderedFixtureInterface;  
use Doctrine\\Common\\Persistence\\ObjectManager;  
use Doctrine\\Common\\DataFixtures\\ReferenceRepository;  
use Fkg\\DemoBundle\\Entity\\Product;  
use Fkg\\DemoBundle\\Entity\\Category;

class ProductFixtures extends AbstractFixture implements OrderedFixtureInterface  
{  
public function load(ObjectManager \$manager)  
{  
\$referenceRepository = new ReferenceRepository(\$manager);

mt\_srand(time());  
for (\$i = 0; \$i \<= 500; \$i++)  
{  
\$faker = \\Faker\\Factory::create();  
\$categoryId = rand(0, 7);  
\$product = new Product();  
\$product-\>setTitle(\$faker-\>words(6, true));  
\$product-\>setContent(\$faker-\>text(250));  
\$product-\>setIsActive(true);  
\$product-\>setContact(\$faker-\>email . '\<br /\>' . \$faker-\>phoneNumber);  
\$product-\>setCreatedAt(new \\DateTime(\$faker-\>dateTimeThisCentury-\>format('Y-m-d H:i:s')));  
\$product-\>setCategory(\$manager-\>merge(\$this-\>getReference("category-{\$categoryId}")));  
\$manager-\>persist(\$product);  
}

\$manager-\>flush();  
}

public function getOrder()  
{  
return 2;  
}  
}

\[/code\]

\> php app/console doctrine:fixtures:load

Faker posiada także sporo innych generatorów treści:
